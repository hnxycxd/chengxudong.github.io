var m=Object.defineProperty,s=Object.defineProperties;var o=Object.getOwnPropertyDescriptors;var u=Object.getOwnPropertySymbols;var d=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable;var i=(e,t,a)=>t in e?m(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,n=(e,t)=>{for(var a in t||(t={}))d.call(t,a)&&i(e,a,t[a]);if(u)for(var a of u(t))E.call(t,a)&&i(e,a,t[a]);return e},l=(e,t)=>s(e,o(t));import{r as react,F as Form,R as React,I as Input,h as Radio,B as Button,T as Table,i as Tag,D as Divider}from"./vendor.80b6e512.js";/* empty css              */var index$c="",index$b="",index$a="",index$9="",index$8="",index$7="",index$6="",index$5="",index$4="",index$3="",index$2="",index$1="",index="",style="";const initialValues={weightUnit:"g"},columns=columnsProps=>[{dataIndex:"name",title:"\u540D\u79F0",align:"center"},{dataIndex:"price",title:"\u552E\u4EF7",align:"center"},{dataIndex:"weight",title:"\u91CD\u91CF",align:"center",render:(text,record)=>React.createElement(React.Fragment,null,React.createElement("span",null,text),React.createElement("span",null,text.includes("*")?` (${eval(text)}${record.weightUnit})`:record.weightUnit))},{dataIndex:"realPrice",title:"\u4EF7\u683C/\u65A4",align:"center",render:e=>React.createElement(Tag,{color:"blue"},e.toFixed(2))},{dataIndex:"remark",title:"\u5907\u6CE8",align:"center"},{dataIndex:"handle",title:"\u64CD\u4F5C",align:"center",render:(e,t)=>React.createElement(React.Fragment,null,React.createElement("a",{onClick:()=>columnsProps.handleEdit(t),style:columnsProps.editing?{color:"#ccc"}:{}},"\u7F16\u8F91"),React.createElement(Divider,{type:"vertical"}),React.createElement("a",{onClick:()=>columnsProps.handleDelete(t),style:columnsProps.editing?{color:"#ccc"}:{}},"\u5220\u9664"))}],Price=()=>{const[dataSource,setDataSource]=react.exports.useState([]),[form]=Form.useForm(),[currentEditItem,setCurrentEditItem]=react.exports.useState(),onFinish=values=>{let newData=[...dataSource];if(currentEditItem)newData=newData.map(e=>e.key===currentEditItem.key?n(n({},e),values):e);else{const e=l(n({},values),{key:newData.length+1});newData.push(e)}newData=newData.map(item=>{const _weight=eval(String(item.weight)),weight=item.weightUnit==="kg"?_weight*1e3:_weight;return item.realPrice=item.price*500/weight,item}).sort((e,t)=>e.realPrice-t.realPrice),setDataSource(newData),setCurrentEditItem(void 0),form.resetFields(["price","weight"])},handleDelete=e=>{if(currentEditItem)return;const t=dataSource.filter(a=>a.key!==e.key);setDataSource(t)},handleEdit=e=>{currentEditItem||(form.setFieldsValue({name:e.name,price:e.price,weight:e.weight,weightUnit:e.weightUnit,remark:e.remark}),setCurrentEditItem(e))},validatorWeight=(e,t)=>{if(!t)return Promise.reject();const a=t.split("*").some(r=>isNaN(+r.trim()));return new Promise((r,c)=>{a?c("\u4F60\u5728\u5199\u5565, \u6211\u770B\u4E0D\u61C2"):r()})},validatorAmount=(e,t)=>new Promise((a,r)=>{t&&isNaN(+t)?r("\u53EA\u80FD\u586B\u6570\u5B57, \u522B\u4E71\u6572"):a()});return React.createElement("div",{className:"price"},React.createElement(Form,{name:"basic",colon:!1,form,labelCol:{span:6},wrapperCol:{span:18},onFinish,initialValues,className:"price_form",autoComplete:"off"},React.createElement(Form.Item,{label:"\u540D\u79F0",name:"name"},React.createElement(Input,{placeholder:"\u4EC0\u4E48\u4E1C\u897F"})),React.createElement(Form.Item,{label:"\u552E\u4EF7",name:"price",rules:[{required:!0,message:"\u4EF7\u683C\u4F60\u90FD\u4E0D\u586B\uFF0C\u6211\u548B\u7B97!"},{validator:validatorAmount}]},React.createElement(Input,{placeholder:"\u591A\u5C11\u94B1",suffix:"\u5143"})),React.createElement(Form.Item,{label:"\u91CD\u91CF",name:"weight",rules:[{required:!0,message:"\u54CE\u5440\uFF0C\u8FD9\u4E2A\u4E5F\u8981\u586B!"},{validator:validatorWeight}]},React.createElement(Input,{placeholder:"\u591A\u91CD"})),React.createElement(Form.Item,{label:"\u5355\u4F4D",name:"weightUnit"},React.createElement(Radio.Group,null,React.createElement(Radio,{value:"g"},"g"),React.createElement(Radio,{value:"kg"},"kg"))),React.createElement(Form.Item,{label:"\u5907\u6CE8",name:"remark"},React.createElement(Input,{placeholder:"\u968F\u4FBF\u5199\u70B9"})),React.createElement(Form.Item,{wrapperCol:{span:18,offset:6}},React.createElement(Button,{htmlType:"submit",type:"primary"},currentEditItem?"\u66F4\u65B0":"\u6DFB\u52A0"))),React.createElement("div",{className:"table_con"},React.createElement(Table,{bordered:!0,className:"table",columns:columns({handleDelete,handleEdit,editing:!!currentEditItem}),pagination:!1,dataSource})))};export{Price as default};
